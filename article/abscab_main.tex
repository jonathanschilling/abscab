%% This template can be used to write a paper for
%% Computer Physics Communications using LaTeX.
%% For authors who want to write a computer program description,
%% an example Program Summary is included that only has to be
%% completed and which will give the correct layout in the
%% preprint and the journal.
%% The `elsarticle' style is used and more information on this style
%% can be found at
%% http://www.elsevier.com/wps/find/authorsview.authors/elsarticle.
%%
%%
\documentclass[preprint,12pt]{elsarticle}

%% Use the option review to obtain double line spacing
%% \documentclass[preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times]{elsarticle}
%% \documentclass[final,1p,times,twocolumn]{elsarticle}
%% \documentclass[final,3p,times]{elsarticle}
%% \documentclass[final,3p,times,twocolumn]{elsarticle}
%% \documentclass[final,5p,times]{elsarticle}
%% \documentclass[final,5p,times,twocolumn]{elsarticle}

%% if you use PostScript figures in your article
%% use the graphics package for simple commands
%% \usepackage{graphics}
%% or use the graphicx package for more complicated commands
\usepackage{graphicx}
%% or use the epsfig package if you prefer to use the old commands
%% \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers after \end{frontmatter}.
%% \usepackage{lineno}

% jons ::: my own packages ::: jons
\usepackage{siunitx}
\usepackage{amsmath}
\usepackage{cancel}
\usepackage{hyperref}

% FloatBarrier
\usepackage{placeins}

\def\eqn#1{Eqn.~(\ref{eqn:#1})}

% \intercal for transpose, \mathbb{R} reals, \mathbb{C} complex numbers
% \usepackage{amssymb} (already provided by template)
% \def\realnumbers{\rm I\!R} % does not generalize to complex numbers...
\def\naturals{\mathbb{N}}
\def\naturalsWithZero{\mathbb{N}_0}
\def\integers{\mathbb{Z}}
\def\realnumbers{\mathbb{R}}
\def\complexnumbers{\mathbb{C}}

% \mathfrak{Re}, \mathfrak{Im}
% \usepackage[frak=esstix]{mathalpha} % on some other systems...
\usepackage[frak=esstix]{mathalfa}
\def\realpart{\mathfrak{Re}}
\def\imagpart{\mathfrak{Im}}

% end ::: my own packages ::: end




%% natbib.sty is loaded by default. However, natbib options can be
%% provided with \biboptions{...} command. Following options are
%% valid:

%%   round  -  round parentheses are used (default)
%%   square -  square brackets are used   [option]
%%   curly  -  curly braces are used      {option}
%%   angle  -  angle brackets are used    <option>
%%   semicolon  -  multiple citations separated by semi-colon
%%   colon  - same as semicolon, an earlier confusion
%%   comma  -  separated by comma
%%   numbers-  selects numerical citations
%%   super  -  numerical citations as superscripts
%%   sort   -  sorts multiple citations according to order in ref. list
%%   sort&compress   -  like sort, but also compresses numerical citations
%%   compress - compresses without sorting
%%
%% \biboptions{comma,round}

% \biboptions{}

%% This list environment is used for the references in the
%% Program Summary
%%
\newcounter{bla}
\newenvironment{refnummer}{%
\list{[\arabic{bla}]}%
{\usecounter{bla}%
 \setlength{\itemindent}{0pt}%
 \setlength{\topsep}{0pt}%
 \setlength{\itemsep}{0pt}%
 \setlength{\labelsep}{2pt}%
 \setlength{\listparindent}{0pt}%
 \settowidth{\labelwidth}{[9]}%
 \setlength{\leftmargin}{\labelwidth}%
 \addtolength{\leftmargin}{\labelsep}%
 \setlength{\rightmargin}{0pt}}}
 {\endlist}

\journal{Computer Physics Communications}

\begin{document}

\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for the associated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for the associated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for the associated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%%
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}

\title{Accurate Biot-Savart Routines with Correct Asymptotic Behavior}

%% use optional labels to link authors explicitly to addresses:
%% \author[label1,label2]{<author name>}
%% \address[label1]{<address>}
%% \address[label2]{<address>}

\author[a]{Jonathan Schilling\corref{author}}
\author[a]{Jakob Svensson}
\author[a]{Udo HÃ¶fel}
\author[a]{Joachim Geiger}
% \author[a,b]{Second Author}
% \author[b]{Third Author}

\cortext[author] {Corresponding author.\\\textit{E-mail address:} jonathan.schilling@ipp.mpg.de}
\address[a]{Max-Planck-Institute for Plasma Physics, Wendelsteinstrasse 1, 17489 Greifswald, Germany}
% \address[b]{Second Address}

\begin{abstract}
A set of routines to compute the magnetic vector potential and magnetic field of two types of current carriers is presented.
The (infinitely thin) current carrier types are a straight wire segment and a circular wire loop.
The routines are highly accurate and exhibit the correct asymptotic behavior far away from and close to the current carrier.
A suitable global set of test points is introduced and the methods presented in this work
are tested against results obtained using arbitrary-precision arithmetic on all test points.
The results are accurate to approximately 16 decimal digits of precision when computed using 64 bit floating point arithmetic,
with few exceptions where accuracy drops to 13 digits.
These primitive current carrier types can be used to make up more complex arrangements,
such as a current along a polygon (by means of defining straight wire segments from point to point along the polygon)
and a multi-winding coil with circular cross-section (by positioning circular wire loops at appropriate positions in the coils cross-section).
Reference data is provided along with the code to compute it
for testing the reader's routines against this work.
\end{abstract}

\begin{keyword}
%% keywords here, in the form: keyword \sep keyword
magnetostatics; Biot-Savart; straight wire segment; circular wire loop; magnetic vector potential; magnetic field
\end{keyword}

\end{frontmatter}

%%
%% Start line numbering here if you want
%%
% \linenumbers

% All CPiP articles must contain the following
% PROGRAM SUMMARY.

{\bf PROGRAM SUMMARY}

\begin{small}
\noindent
{\em Program Title:} Accurate Biot-Savart routines with Correct Asymptotic Behavior \\
{\em CPC Library link to program files:} (to be added by Technical Editor) \\
{\em Developer's repository link:} https://github.com/jonathanschilling/abscab \\
{\em Code Ocean capsule:} (to be added by Technical Editor)\\
{\em Licensing provisions:} Apache-2.0 \\
{\em Programming language:} C, Python, Java, Fortran \\
{\em Supplementary material:} Reference output data for all methods described in this article. \\
{\em Nature of problem:}\\
  A common task in computational physics is to compute the magnetic field and magnetic vector potential
  originating from current-carrying wire arrangements in the form of coils and cables.
  These current carriers can be approximated for computational simplicity as infinitely thin filaments
  following the center lines of the real current carrier.
  A current carrier path specified by a list of points along the path
  can be modeled as a set of straight wire segments from point to point along the polygon describing the current carrier geometry.
  Closed circular wire loops appear as well in practise and can be chosen to model, e.g.,
  individual windings in a circular coil.
  Computational methods are thus needed to compute the magnetic field and the magnetic vector potential
  of a single straight wire segment or a single circular wire loop
  in order to model more complex current carrier arrangements
  by superposition of the current carrier primitives. \\
{\em Solution method(approx. 50-250 words):}\\
  Analytical expressions are derived in this work to accurately compute
  the magnetic field and the magnetic vector potential of a straight wire segment
  and a circular wire loop. The expressions consist of several special cases,
  which are switched between depending on the location of the evaluation location
  in the coordinate system of the current carrier primitive.
  This approach allows to select the most accurate formulation
  for a given evaluation location and make explicit use of simplications
  in certain special cases for the sake of simplicity, speed and accuracy.
  Particular attention was paid to make sure that the expressions presented in this work
  obey the correct asymptotic behavior for evaluation locations
  far away from and close to the current carriers. \\
{\em Additional comments including restrictions and unusual features (approx. 50-250 words):}\\
  For most test cases, the full relative accuracy of the floating point
  arithmetic chosen for implementation is retained throughout the computations
  (16 digits of precision in the \texttt{binary64} implementation),
  with few exceptions where accuracy drops by up to 2 digits of precision
  (in the \texttt{binary64} case).
  The provided implementations have not been optimized for speed. \\
\end{small}

%% main text
\include{abscab_Introduction.tex}
\include{abscab_Methods.tex}
\include{abscab_Results.tex}
\include{abscab_Discussion.tex}
\include{abscab_Outlook.tex}
\include{abscab_Acknowledgments.tex}

%% The Appendices part is started with the command \appendix;
%% appendix sections are then done as normal sections
\appendix

%% \section{}
%% \label{}

\include{abscab_appendix_DerivationOfMethods.tex}

\include{abscab_appendix_ReferenceData.tex}


%% References
%%
%% Following citation commands can be used in the body text:
%% Usage of \cite is as follows:
%%   \cite{key}         ==>>  [#]
%%   \cite[chap. 2]{key} ==>> [#, chap. 2]
%%

%% References with bibTeX database:

\bibliographystyle{elsarticle-num}
\bibliography{bibliography.bib}

%% Authors are advised to submit their bibtex database files. They are
%% requested to list a bibtex style file in the manuscript if they do
%% not want to use elsarticle-num.bst.

%% References without bibTeX database:

% \begin{thebibliography}{00}

%% \bibitem must have the following form:
%%   \bibitem{key}...
%%

% \bibitem{}

% \end{thebibliography}


\end{document}

%%
%% End of file
