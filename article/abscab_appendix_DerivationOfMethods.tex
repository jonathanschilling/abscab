\section{Derivations}
\label{apx:derivations}
The derivations of the formulas presented in Sec.~\ref{sec:methods} are given here.

\subsection{Straight Wire Segment}
The following geometric quantities with $\mathbf{x}_f \equiv \mathbf{x}_{i+1}$ are defined to ease the rest of the derivation:
\begin{align}
 L                   & \equiv | \mathbf{x}_f - \mathbf{x}_i | \, , \\
 \hat{\mathbf{e}}    & \equiv \left(\mathbf{x}_f - \mathbf{x}_i\right) / L \, , \\
 \mathbf{R}_i        & \equiv \mathbf{x} - \mathbf{x}_i \, , \\
 \mathbf{R}_f        & \equiv \mathbf{x} - \mathbf{x}_f \, , \\
 R_i                 & \equiv | \mathbf{R}_i | = | \mathbf{x} - \mathbf{x}_i | \, , \\
 R_f                 & \equiv | \mathbf{R}_f | = | \mathbf{x} - \mathbf{x}_f | \, , \\
 R_{i ||}            & \equiv \hat{\mathbf{e}} \cdot \mathbf{R}_i \, , \\
 R_{f ||}            & \equiv \hat{\mathbf{e}} \cdot \mathbf{R}_f \, , \\
 \mathbf{R}_\perp    & \equiv \mathbf{R}_i - R_{i ||} \hat{\mathbf{e}} \, , \\
 R_\perp             & \equiv | \mathbf{R}_\perp | \quad \mathrm{and} \\
 \mathbf{c}(\lambda) & \equiv \mathbf{x}_i + \lambda \left(\mathbf{x}_f - \mathbf{x}_i\right) \quad \mathrm{for} \quad 0 \leq \lambda \leq 1 \, .
\end{align}
The following relations are also needed:
\begin{align}
       L             & = R_{i ||} - R_{f ||} \\
       R_i^2 - R_f^2 & = L \left( R_{i ||} + R_{f ||} \right) \\
\Rightarrow R_{i ||} & = \frac{R_i^2 - R_f^2}{2 L} + \frac{L}{2} \\
\Rightarrow R_{f ||} & = \frac{R_i^2 - R_f^2}{2 L} - \frac{L}{2}
\end{align}

\subsubsection{Magnetic Vector Potential}
The law of Biot and Savart for the magnetic vector potential of a current density distribution $\mathbf{j}(\mathbf{x})$ is as follows~\cite{jackson}:
\begin{equation}
 \mathbf{A}(\mathbf{x}) = \frac{\mu_0}{4 \pi} \int \frac{\mathbf{j}(\mathbf{x}')}{|\mathbf{x} - \mathbf{x}'|} \mathrm{d}\mathbf{x}' \, .
\end{equation}
The parametrization of points on the line segment $\mathbf{c}(\lambda)$ can be used to apply this to the given geometry of a wire segment:
\begin{align}
 \mathbf{A}(\mathbf{x}) & = \frac{\mu_0 I}{4 \pi} L \hat{\mathbf{e}} \int\limits_0^1 \frac{\mathrm{d}\lambda}{|\mathbf{x} - \mathbf{c}(\lambda)|} \\
        ~               & = \frac{\mu_0 I}{4 \pi} L \hat{\mathbf{e}} \int\limits_0^1 \frac{\mathrm{d}\lambda}{|\mathbf{x} - \mathbf{x}_i - \lambda L \hat{\mathbf{e}}|} \, .
\end{align}
A little bit of geometric intuition is needed to simplify the denominator of the integral:
\begin{align}
 \mathbf{x} - \mathbf{x}_i - \lambda L \hat{\mathbf{e}}
   & = \mathbf{R}_i - \lambda L \hat{\mathbf{e}} \\
 ~ & = \mathbf{R}_i - R_{i ||} \hat{\mathbf{e}} + R_{i ||} \hat{\mathbf{e}} - \lambda L \hat{\mathbf{e}} \\
 ~ & = \mathbf{R}_i - R_{i ||} \hat{\mathbf{e}} + \left( R_{i ||} - \lambda L \right) \hat{\mathbf{e}} \\
 ~ & = \mathbf{R}_\perp + \left( R_{i ||} - \lambda L \right) \hat{\mathbf{e}} \, .
\end{align}
Note that, in particular, $\mathbf{R}_\perp \perp \hat{\mathbf{e}}$ and thus (since $|\hat{\mathbf{e}}|$ = 1) due to Pythagoras:
\begin{equation}
 | \mathbf{x} - \mathbf{x}_i - \lambda L \hat{\mathbf{e}} |^2 = R_\perp^2 + \left( R_{i ||} - \lambda L \right)^2
\end{equation}
and finally with $R_\perp^2 = R_i^2 - R_{i ||}^2$ (also due to Pythagoras):
\begin{align}
 | \mathbf{x} - \mathbf{x}_i - \lambda L \hat{\mathbf{e}} |^2
   & = R_i^2 - R_{i ||}^2 + R_{i ||}^2 - 2 \lambda L R_{i ||} + \lambda^2 L^2 \\
 ~ & = R_i^2 - 2 \lambda L R_{i ||} + \lambda^2 L^2 \, .
\end{align}
It follows:
\begin{equation}
 \mathbf{A}(\mathbf{x})
 = \frac{\mu_0 I}{4 \pi} L \hat{\mathbf{e}} \int\limits_0^1 \frac{\mathrm{d}\lambda}{\sqrt{R_i^2 - 2 \lambda L R_{i ||} + \lambda^2 L^2}} \, . \label{eqn:A_integral}
\end{equation}
The following relation holds for
$R = a + bx + cx^2$,
$\Delta = 4 a c - b^2$ with
$c > 0$, $2 c x + b > \sqrt{- \Delta}$ and $\Delta < 0$
according to integral (2.261) in Ref.~\cite{gradshteyn_ryzhik}:
\begin{equation}
 \int \frac{\mathrm{d}x}{\sqrt{R}} = \frac{1}{\sqrt{c}} \log \left( 2 \sqrt{c R} + 2 c x + b \right) \, .
\end{equation}

{\color{red}
TODO: prove applicability !!!
}

Here, $x = \lambda$, $a=R_i^2$, $b=-2 L R_{i ||}$ and $c = L^2$.
The corresponding antiderivative of the integrand in \eqn{A_integral} is:
\begin{align}
 \int&\frac{\mathrm{d}\lambda}{\sqrt{R_i^2 - 2 \lambda L R_{i ||} + \lambda^2 L^2}} \nonumber \\
 =&\, \frac{1}{L} \log \left( 2 \sqrt{L^2\left( L^2 \lambda^2 - 2 L R_{i ||} \lambda + R_i^2 \right)} + 2 L^2 \lambda - 2 L R_{i ||} \right) \, .
\end{align}
The definite integral in \eqn{A_integral} is therefore solved by the following expression:
\begin{align}
 ~ & \int\limits_0^1 \frac{\mathrm{d}\lambda}{\sqrt{R_i^2 - 2 \lambda L R_{i ||} + \lambda^2 L^2}} \\
 = & \frac{1}{L} \Biggl[\phantom{-}\, \log \left( 2 \sqrt{L^2\left( L^2 - 2 L R_{i ||} + R_i^2 \right)} + 2 L^2 - 2 L R_{i ||} \right) \nonumber \\
 ~ & \phantom{\frac{1}{L} \Biggl[} - \log \left( 2 \sqrt{L^2 R_i^2 } - 2 L R_{i ||} \right) \Biggr] \\
 = & \frac{1}{L} \log \left( \frac{ \bcancel{2 L} \sqrt{L^2 - 2 L R_{i ||} + R_i^2} + \bcancel{2} L^{\bcancel{2}} - \bcancel{2 L} R_{i ||} }{ \bcancel{2 L} R_i - \bcancel{2 L} R_{i ||} } \right)
\end{align}
Note that
\begin{align}
                             L^2 & = L (R_{i ||} - R_{f ||} ) \\
                              ~  & = L R_{i ||} - L R_{f ||} \\
\Rightarrow -2 L R_{i ||} + L^2  & = - \bcancel{2} L R_{i ||}  + \bcancel{L R_{i ||}} - L R_{f ||} \\
                              ~  & = -L (R_{i ||} + R_{f ||} ) \\
                              ~  & = R_f^2 - R_i^2 \\
\Rightarrow                R_f^2 & = R_i^2 -2 L R_{i ||} + L^2 \, .
\end{align}
Therefore:
\begin{equation}
 \int\limits_0^1 \frac{\mathrm{d}\lambda}{\sqrt{R_i^2 - 2 \lambda L R_{i ||} + \lambda^2 L^2}}
 = \frac{1}{L} \log \left( \frac{ R_f - R_{f ||} }{ R_i - R_{i  \,\mathrm{d}\varphi||} } \right) \, .
\end{equation}
Inserting this into \eqn{A_integral} leads to the first intermediate result:
\begin{equation}
   \mathbf{A}(\mathbf{x})
 = \frac{\mu_0 I}{4 \pi} \bcancel{L} \bcancel{\frac{1}{L}} \log \left( \frac{ R_f - R_{f ||} }{ R_i - R_{i ||} } \right) \hat{\mathbf{e}}
 = \frac{\mu_0 I}{4 \pi}                                   \log \left( \frac{ R_f - R_{f ||} }{ R_i - R_{i ||} } \right) \hat{\mathbf{e}} \, . \label{eqn:A_first}
\end{equation}
However, if the point $\mathbf{x}$ is located on the line extension of the wire segment, $R_i = R_{i ||}$ and $R_f = R_{f ||}$,
which leads to a $0/0$ division if this formula is directly evaluated.
The solution is to cancel the singular term $(L + R_f - R_i)$, which is also zero for points on the line extension of the wire segment,
in the numerator and the denominator of \eqn{A_first}.
A second look resolves this:
\begin{align}
\frac{ R_f - R_{f ||} }{ R_i - R_{i ||} }
 = & \frac{ 2 L \left( R_f - R_{f ||} \right) }{ 2 L \left( R_i - R_{i ||} \right) }
 =   \frac{ 2 L R_f - 2 L \left( \frac{R_i^2 - R_f^2}{2 L} - \frac{L}{2} \right) }{ 2 L R_i - 2 L \left( \frac{R_i^2 - R_f^2}{2 L} + \frac{L}{2} \right) } \\
 = & \frac{ 2 L R_f - R_i^2 + R_f^2 + L^2 }{ 2 L R_i - R_i^2 + R_f^2 - L^2 } \\
 = & \frac{ 2 L R_f - R_i^2 + R_f^2 + L^2 + L R_i - L R_i + R_i R_f - R_i R_f}{ 2 L R_i - R_i^2 + R_f^2 - L^2 + L R_f - L R_f + R_i R_f - R_i R_f } \\
 = & \frac{\bcancel{(L + R_f - R_i)}(R_f + R_i + L)}{\bcancel{(L + R_f - R_i)}(R_f + R_i - L)}
 =   \frac{R_f + R_i + L}{R_f + R_i - L} \, .
\end{align}
It follows for the vector potential expression:
\begin{equation}
 \mathbf{A}(\mathbf{x}) = \frac{\mu_0 I}{4 \pi} \log \left( \frac{R_f + R_i + L}{R_f + R_i - L} \right) \hat{\mathbf{e}} \, . \label{eqn:A_second}
\end{equation}
The authors of Ref.~\cite{hanson_hirshman_2002} suggest to normalize the length of the wire segment:
\begin{equation}
 \frac{R_f + R_i + L}{R_f + R_i - L} = \frac{1 + \epsilon}{1 - \epsilon} \quad \mathrm{with} ~ \epsilon \equiv \frac{L}{R_i + R_f} \, ,
\end{equation}
leading to
\begin{equation}
 \mathbf{A}(\mathbf{x}) = \frac{\mu_0 I}{4 \pi} \log\left(\frac{1 + \epsilon}{1 - \epsilon} \right) \hat{\mathbf{e}} \, . \label{eqn:A_log_eps}
\end{equation}
This is the result for the magnetic vector potential of a filamentary wire segment presented in Ref.~\cite{hanson_hirshman_2002}.
Note that
\begin{equation}
 \mathrm{artanh}\left( \epsilon \right) = \frac{1}{2} \log\left(\frac{1 + \epsilon}{1 - \epsilon} \right) \, ,
\end{equation}
leading to
\begin{equation}
 \mathbf{A}(\mathbf{x}) = \frac{\mu_0 I}{2 \pi} \, \mathrm{artanh} \left( \epsilon \right) \hat{\mathbf{e}} \, . \label{eqn:A_artanh}
\end{equation}

\subsubsection{Magnetic Field}
The law of Biot and Savart for the magnetic field of a current density distribution $\mathbf{j}(\mathbf{x})$ is as follows~\cite{jackson}:
\begin{equation}
 \mathbf{B}(\mathbf{x}) = \frac{\mu_0}{4 \pi} \int \mathbf{j}(\mathbf{x}') \times \frac{\mathbf{x} - \mathbf{x}'~}{|\mathbf{x} - \mathbf{x}'|^3} \mathrm{d}\mathbf{x}' \, .
\end{equation}
The magnetic field $\mathbf{B}(\mathbf{x})$ is computed from $\mathbf{B} = \nabla \times \mathbf{A}$, applied to \eqn{A_log_eps}.
Define
\begin{equation}
 f(\epsilon) \equiv \log\left(\frac{1 + \epsilon}{1 - \epsilon} \right)
\end{equation}
and it follows:
\begin{equation}
  \frac{4 \pi}{\mu_0 I} \mathbf{B}
 = \nabla \times \left( f(\epsilon) \hat{\mathbf{e}} \right)
 = \nabla f(\epsilon) \times \hat{\mathbf{e}} + f(\epsilon) \underbrace{\nabla \times \hat{\mathbf{e}}}_{=0}
 = f'(\epsilon) \nabla \epsilon \times \hat{\mathbf{e}} \, .
\end{equation}
Note that
\begin{align}
   \nabla \epsilon
 =&\, \nabla \left( \frac{L}{R_i + R_f} \right)
 = \frac{-L}{(R_i + R_f)^2}\left( \nabla R_i + \nabla R_f \right) \nonumber \\
 =&\, \frac{-L}{(R_i + R_f)^2}\left( \frac{\mathbf{R}_i}{R_i} + \frac{\mathbf{R}_f}{R_f} \right) \, .
\end{align}
It follows:
\begin{align}
   \frac{4 \pi}{\mu_0 I} \mathbf{B}
 = & f'(\epsilon) \frac{-L}{(R_i + R_f)^2} \left( \frac{\mathbf{R}_i}{R_i} + \frac{\mathbf{R}_f}{R_f} \right) \times \hat{\mathbf{e}} \\
 = & f'(\epsilon) \frac{L}{(R_i + R_f)^2} \, \hat{\mathbf{e}} \times \left( \frac{\mathbf{R}_i}{R_i} + \frac{\mathbf{R}_f}{R_f} \right) \\
 = & f'(\epsilon) \frac{\epsilon^2}{L}    \, \hat{\mathbf{e}} \times \left( \frac{\mathbf{R}_i}{R_i} + \frac{\mathbf{R}_f}{R_f} \right) \, . \label{eqn:B_intermediate}
\end{align}
Also:
\begin{align}
   \frac{\mathbf{R}_i}{R_i} + \frac{\mathbf{R}_f}{R_f}
 =&\, \frac{\mathbf{R}_i}{R_i} + \frac{\mathbf{R}_i - L \hat{\mathbf{e}} }{R_f}
 =   \frac{R_f \mathbf{R}_i + R_i (\mathbf{R}_i - L \hat{\mathbf{e}}) }{R_i R_f} \nonumber \\
 =&\,   \frac{(R_f+R_i) \mathbf{R}_i + R_i L \hat{\mathbf{e}} }{R_i R_f}
 = \frac{R_f+R_i}{R_i R_f} \mathbf{R}_i + \frac{R_i L}{R_i R_f} \, \hat{\mathbf{e}}
\end{align}
and therefore:
\begin{equation}
   \hat{\mathbf{e}} \times \left( \frac{\mathbf{R}_i}{R_i} + \frac{\mathbf{R}_f}{R_f} \right)
 = \hat{\mathbf{e}} \times \left( \frac{R_f+R_i}{R_i R_f} \mathbf{R}_i + \frac{R_i L}{R_i R_f} \, \hat{\mathbf{e}} \right)
 = \frac{R_f+R_i}{R_i R_f} \, \hat{\mathbf{e}} \times \mathbf{R}_i \, ,
\end{equation}
since $\hat{\mathbf{e}} \times \hat{\mathbf{e}} = 0$.
Inserting this into \eqn{B_intermediate} leads to:
\begin{equation}
   \frac{4 \pi}{\mu_0 I} \mathbf{B}
 = f'(\epsilon) \frac{\epsilon^{\bcancel{2}}}{\bcancel{L}} \, \frac{\bcancel{R_f+R_i}}{R_i R_f} \, \hat{\mathbf{e}} \times \mathbf{R}_i
 = f'(\epsilon) \frac{\epsilon}{R_i R_f} \, \hat{\mathbf{e}} \times \mathbf{R}_i \label{eqn:B_intermediate_2}
\end{equation}
Next, look at $f'(\epsilon)$:
\begin{equation}
   f'(\epsilon)
 = \frac{\bcancel{1 - \epsilon}}{1 + \epsilon} \frac{1 (1-\epsilon) - (1+\epsilon) (-1)}{(1 - \epsilon)^{\bcancel{2}}}
 = \frac{1 - \epsilon + 1 + \epsilon}{(1 + \epsilon)(1 - \epsilon)}
 = \frac{2}{1 - \epsilon^2}
\end{equation}
and insert this into \eqn{B_intermediate_2}:
\begin{align}
   \frac{4 \pi}{\mu_0 I} \mathbf{B}
 = & \frac{2 \epsilon}{1 - \epsilon^2} \frac{1}{R_i R_f} \, \hat{\mathbf{e}} \times \mathbf{R}_i \\
 = & \frac{2 L}{\bcancel{R_i + R_f}} \frac{(R_i + R_f)^{\bcancel{2}}}{(R_i + R_f)^2 - L^2} \frac{1}{R_i R_f} \, \hat{\mathbf{e}} \times \mathbf{R}_i \, .
\end{align}
This results in the final expression for the magnetic field:
\begin{equation}
 \mathbf{B} (\mathbf{x}) = \frac{\mu_0 I}{4 \pi} \frac{2 L (R_i + R_f)}{R_i R_f} \frac{1}{(R_i + R_f)^2 - L^2} \, \hat{\mathbf{e}} \times \mathbf{R}_i \, .
\end{equation}

\subsection{Circular Wire Loop}
The derivation of the circular wire loop formulas is considered next.

\subsubsection{Magnetic Vector Potential}
The derivation starts at the expression given by Jackson~\cite{jackson}
and listed here in~\eqn{cwl_A_phi_Jackson}.
Normalized coordinates~$(\rho', z')$ as introduced in~\eqn{rhoP} and~\eqn{zP}
are used to reformulate the expression given by Jackson into the following:
\begin{equation}
 A_\varphi(\rho', z')
   = \frac{\mu_0 I}{\pi}
     \frac{1}{\sqrt{z'^2 + (1 + \rho')^2}}
     \left[ \frac{(2 - k^2)\mathcal{K}(k) - 2 \mathcal{E}(k)}{k^2} \right] \, . \label{eqn:cwl_A_phi_initial}
\end{equation}
A normalizing prefactor is split off according to~\eqn{norm_A_phi}.
The remaining term~$\tilde{A}_\varphi(\rho',z')$ only depends on the geometry of the wire loop
and the evalation location:
\begin{equation}
  \tilde{A}_\varphi(\rho', z')
  = \frac{1}{\sqrt{z'^2 + (1 + \rho')^2}}
    \left[ \frac{(2 - k^2)\mathcal{K}(k) - 2 \mathcal{E}(k)}{k^2} \right] \, . \label{eqn:aNormJackson}
\end{equation}
Cancellations can happen in the numerical evaluation of~\eqn{aNormJackson}~\cite{bulirsch_3}.
Therefore, another form for~$\tilde{A}_\varphi(\rho',z')$ can be found by employing
formulas from Ref.~\cite{jahnke_emde} (Section V.B.11 on page 73 therein):
\begin{align}
                 \mathcal{K}(k) =&\, \mathcal{E}(k) + k^2 \mathcal{D}(k) \nonumber \\
 \Leftrightarrow \mathcal{D}(k) =&\, \frac{\mathcal{K}(k) - \mathcal{E}(k)}{k^2} \\
               2 \mathcal{D}(k) =&\, \mathcal{K}(k) + k^2 \mathcal{C}(k) \nonumber \\
 \Leftrightarrow k^2 \mathcal{C}(k) =&\, 2 \mathcal{D}(k) - \mathcal{K}(k) \nonumber \\
                     ~              =&\, 2 \left( \frac{\mathcal{K}(k) - \mathcal{E}(k)}{k^2} \right) - \mathcal{K}(k) \nonumber \\
                     ~              =&\, \frac{(2 - k^2) \mathcal{K}(k) - 2 \mathcal{E}(k)}{k^2} \, . \label{eqn:kSqC}
\end{align}
It is notes that the corresponding expression for~$\mathcal{C}$ given in Eqn.~(12) of Ref.~\cite{walstrom_2017}
has a the wrong sign.
Application of~\eqn{kSqC} to~\eqn{aNormJackson} leads to:
\begin{equation}
  \tilde{A}_\varphi(\rho', z')
  = \frac{k^2}{\sqrt{z'^2 + (1 + \rho')^2}} \,\mathcal{C}(k)\, .
\end{equation}
This is the far-field method used in~\eqn{cwl_A_phi_f}.
Note that~$\mathcal{C}(k)$ can be evaluated as follows~\cite{bulirsch_1, bulirsch_3}:
\begin{align}
  \mathcal{C}(k) =&\, \textrm{cel2}\,\left(\frac{2 \sqrt{|k_c|}}{1+|k_c|},0,\frac{2}{(1+|k_c|)^3}\right) \nonumber \\
       ~         =&\, \textrm{cel}\,\left(\frac{2 \sqrt{|k_c|}}{1+|k_c|},1,0,\frac{2}{(1+|k_c|)^3}\right) \, .
\end{align}
The absolute value around~$k_c$ is otherwise omitted in this work
because~$k_c \geq 0$ always holds for the formulation of~$k_c$ used in this work.
\eqn{cwl_A_phi_initial}~is a linear combination of the complete elliptic integrals
of the first and second kind and can be handled by the \texttt{cel}~function
introduced by Bulirsch~\cite{bulirsch_3}:
\begin{equation}
  \lambda \mathcal{K} (k) + \mu \mathcal{E} (k) = \textrm{cel}\,(k_c, 1, \lambda + \mu, \lambda + \mu k_c^2) \, .
\end{equation}
Here, $\lambda = (2 - k^2)/k^2$ and $\mu = -2/k^2$,
leading to:
\begin{align}
  \lambda + \mu       =&\, \frac{2 - k^2}{k^2} - \frac{2}{k^2} \nonumber \\
      ~               =&\, \frac{\bcancel{2} - k^2 \bcancel{-2}}{k^2} = -1 \nonumber \\
  \lambda + \mu k_c^2 =&\, \frac{2 - k^2}{k^2} - \frac{2 (1 - k^2)}{k^2} \nonumber \\
      ~               =&\, \frac{\bcancel{2} - k^2 \bcancel{-2} + 2 k^2}{k^2} = 1
\end{align}
Putting things together, this implies:
\begin{equation}
 \frac{(2 - k^2)\mathcal{K}(k) - 2 \mathcal{E}(k)}{k^2} = \textrm{cel}\,(k_c, 1, -1, 1) \, . \label{eqn:cel_kc_1}
\end{equation}
Thus, $\tilde{A}_\varphi(\rho',z')$~can be expressed as follows:
\begin{equation}
 \tilde{A}_\varphi(\rho',z')
 = \frac{1}{\sqrt{z'^2 + (1 + \rho')^2}}
   \textrm{cel}\,(k_c, 1, -1, 1) \, . \label{eqn:cwl_A_phi_using_cel}
\end{equation}
This is equivalent to Eqn.~(3.2.1.6) in Ref.~\cite{teal}.
The near-field (close to~$\rho' = 1$) is handled by normalizing terms to~$\rho'-1$:
\begin{equation}
 \tilde{A}_\varphi(\rho',z')
 = \frac{1}{|\rho'-1| \sqrt{\left(\frac{z'}{\rho'-1}\right)^2 + \left(1 + \frac{2}{\rho'-1}\right)^2}}
   \textrm{cel}\,(k_c, 1, -1, 1) \label{eqn:cwl_A_phi_near} \, .
\end{equation}
Introduce~$n$ and~$m$ with:
\begin{align}
  n \equiv&\, \frac{z'}{\rho'-1} \\
  m \equiv&\, \frac{\rho' + 1}{\rho'-1}
    = 1 + \frac{2}{\rho' - 1}
\end{align}
where the following was used:
\begin{equation}
    \frac{\rho' + 1}{\rho' - 1}
  = \frac{\rho'-1 + 2}{\rho' - 1}
  = 1 + \frac{2}{\rho' - 1} \, .
\end{equation}
This implies:
\begin{equation}
 \tilde{A}_\varphi(\rho',z')
 = \frac{1}{|\rho'-1| \sqrt{n^2 + m^2}} \textrm{cel}\,(k_c, 1, -1, 1) \, .
\end{equation}
and
\begin{align}
  k_c^2
 =&\, \frac{\left(\frac{z'}{\rho'-1}\right)^2 + \left( \frac{\rho' - 1}{\rho'-1} \right)^2}
           {\left(\frac{z'}{\rho'-1}\right)^2 + \left( \frac{\rho' + 1}{\rho'-1} \right)^2} \nonumber \\
 =&\, \frac{n^2 + 1}
           {n^2 + m^2} \, . \label{eqn:cwl_kCSq_mn}
\end{align}
The formulation presented in~\eqn{cwl_A_phi_near} is used in~\eqn{cwl_A_phi_n}.
It remains to derive the special case formulation used in~\eqn{cwl_A_phi_v} for~$\rho'=1$.
First, it is noted that inserting~$\rho'=1$ into~$k_c^2$ from~\eqn{kCSq_general} leads to:
\begin{equation}
  k_c^2 = \frac{z'^2}{z'^2 + 4} \, .
\end{equation}
This implies the following form of the factor in front of cel in~\eqn{cwl_A_phi_using_cel}
for the case of~$\rho'=1$:
\begin{equation}
  \frac{1}{\sqrt{z'^2 + 4}} = \frac{k_c}{|z'|} \, .
\end{equation}
It follows~\cite{bulirsch_3}:
\begin{align}
  \tilde{A}_\varphi(\rho'=1,z') =&\, \frac{k_c}{|z'|} \textrm{cel}\,(k_c, 1, -1, 1) \nonumber \\
  ~ =&\, \frac{k_c}{|z'|} \int\limits_0^{\pi/2} \frac{\sin^2(\varphi) - \cos^2(\varphi)}{\sqrt{\cos^2(\varphi) + k_c^2 \sin^2(\varphi)}} \,\mathrm{d}\varphi \nonumber \\
  ~ =&\,   \frac{1}{|z'|} \int\limits_0^{\pi/2} \frac{\sin^2(\varphi) - \cos^2(\varphi)}{\sqrt{\sin^2(\varphi) + \frac{1}{k_c^2} \cos^2(\varphi)}} \,\mathrm{d}\varphi \, .
\end{align}
A change of variables is performed from~$\varphi$ to~$\beta = \varphi - \pi/2 \Leftrightarrow \varphi = \beta + \pi/2$:
\begin{align}
 ~&\,  \int\limits_0^{\pi/2} \frac{\sin^2(\varphi) - \cos^2(\varphi)}{\sqrt{\sin^2(\varphi) + \frac{1}{k_c^2} \cos^2(\varphi)}} \,\mathrm{d}\varphi \nonumber \\
 =&\, \int\limits_{-\pi/2}^{0} \frac{\sin^2(\beta + \pi/2) - \cos^2(\beta + \pi/2)}{\sqrt{\sin^2(\beta + \pi/2) + \frac{1}{k_c^2} \cos^2(\beta + \pi/2)}} \,\mathrm{d}\beta \, .
\end{align}
The shift in the arguments to~$\sin$ and~$\cos$ are incorporated according to:
\begin{align}
  \cos(\beta + \pi/2) =&\,          -    \sin{\beta} \\
  \sin(\beta + \pi/2) =&\, \phantom{-}\, \cos{\beta} \, .
\end{align}
This leads to:
\begin{align}
 ~  &\, \int\limits_{-\pi/2}^{0} \frac{\sin^2(\beta + \pi/2) - \cos^2(\beta + \pi/2)}{\sqrt{\sin^2(\beta + \pi/2) + \frac{1}{k_c^2} \cos^2(\beta + \pi/2)}} \,\mathrm{d}\beta \nonumber \\
 ~ =&\, \int\limits_{-\pi/2}^{0} \frac{\cos^2(\beta) - \sin^2(\beta)}{\sqrt{\cos^2(\beta ) + \frac{1}{k_c^2} \sin^2(\beta)}} \,\mathrm{d}\beta \, .
\end{align}
The limits of the integral are swapped and a negative sign is introduced in order to compensate this:
\begin{equation}
   \frac{1}{|z'|} \int\limits_{-\pi/2}^{0} \frac{\cos^2(\beta) - \sin^2(\beta)}{\sqrt{\cos^2(\beta ) + \frac{1}{k_c^2} \sin^2(\beta)}} \,\mathrm{d}\beta
 = \frac{-1}{|z'|} \int\limits_{0}^{-\pi/2} \frac{\cos^2(\beta) - \sin^2(\beta)}{\sqrt{\cos^2(\beta ) + \frac{1}{k_c^2} \sin^2(\beta)}} \,\mathrm{d}\beta \, .
\end{equation}
Another change of variables~$\varphi = -\beta$ is performed.
This integrand is even-symmetric and thus, the change of variables leads to
the following expression:
\begin{equation}
   \frac{-1}{|z'|} \int\limits_{0}^{-\pi/2} \frac{\cos^2(\beta) - \sin^2(\beta)}{\sqrt{\cos^2(\beta ) + \frac{1}{k_c^2} \sin^2(\beta)}} \,\mathrm{d}\beta
 = \frac{1}{|z'|} \int\limits_{0}^{\pi/2} \frac{\cos^2(\varphi) - \sin^2(\varphi)}{\sqrt{\cos^2(\varphi) + \frac{1}{k_c^2} \sin^2(\varphi)}} \,\mathrm{d}\varphi \, .
\end{equation}
Note that the negative sign at the front has been incorporated into the sign change of the integration differential.
This result can now be evaluated using cel again:
\begin{equation}
  \tilde{A}_\varphi(\rho'=1,z') = \frac{1}{|z'|} \textrm{cel}\,\left(\frac{1}{k_c}, 1, 1, -1\right) \, .
\end{equation}
This is the formulation used in~\eqn{cwl_A_phi_v}.

\subsubsection{Magnetic Field}
The cylindrical components of the magnetic field are computed from~$\mathbf{B} = \nabla \times \mathbf{A}$.
The magnetic vector potential~$\mathbf{A}$ only has a tangential component~$A_\varphi$.
This implies that the magnetic field only has components in radial~($B_\rho$) and vertical~($B_z$) direction:
\begin{align}
  B_\rho =&\, - \frac{\partial A_\varphi}{\partial z} \\
  B_z    =&\, \frac{1}{\rho} \frac{\partial \left(\rho A_\varphi\right)}{\partial \rho}
         =    \frac{A_\varphi}{\rho} + \frac{\partial A_\varphi}{\partial \rho} \, .
\end{align}
The chain rule is applied to the partial derivatives of~$A_\varphi$
in order to take derivatives with respect to the normalized coordinates~$\rho'=\rho/a$ and~$z'=z/a$,
where $a$~is the radius of the wire loop:
\begin{align}
      \frac{\partial A_\varphi}{\partial \rho}
 =&\, \frac{\partial A_\varphi}{\partial \rho'} \frac{\partial \rho'}{\partial \rho}
 =    \frac{1}{a} \frac{\partial A_\varphi}{\partial \rho'} \\
      \frac{\partial A_\varphi}{\partial z}
 =&\, \frac{\partial A_\varphi}{\partial z'} \frac{\partial z'}{\partial z}
 =    \frac{1}{a} \frac{\partial A_\varphi}{\partial z'} \, .
\end{align}
This implies:
\begin{align}
  B_\rho =&\, - \frac{1}{a} \frac{\partial A_\varphi}{\partial z'} \\
  B_z    =&\, \frac{1}{a} \left( \frac{A_\varphi}{\rho'} + \frac{\partial A_\varphi}{\partial \rho'} \right) \, .
\end{align}
The form of~$A_\varphi$ from~\eqn{norm_A_phi} is inserted into these expressions
for the magnetic field components:
\begin{align}
  B_\rho =&\, - \frac{1}{a} \frac{\partial}{\partial z'} \left( \frac{\mu_0 I}{\pi} \tilde{A}_\varphi \right)
         =    - \frac{\mu_0 I}{\pi a} \frac{\partial \tilde{A}_\varphi}{\partial z'} \\
  B_z    =&\, \frac{1}{a} \left( \frac{\mu_0 I}{\pi} \frac{\tilde{A}_\varphi}{\rho'} + \frac{\partial}{\partial \rho'} \left( \frac{\mu_0 I}{\pi} \tilde{A}_\varphi \right) \right)
         =    \frac{\mu_0 I}{\pi a} \left(\frac{\tilde{A}_\varphi}{\rho'} + \frac{\partial \tilde{A}_\varphi}{\partial \rho'} \right) \, .
\end{align}
This allows to define normalized components of the magnetic field:
\begin{align}
  B_\rho =&\, \frac{\mu_0 I}{\pi a} \tilde{B}_\rho \\
  B_z    =&\, \frac{\mu_0 I}{\pi a} \tilde{B}_z
\end{align}
with
\begin{align}
  \tilde{B}_\rho =&\, - \frac{\partial \tilde{A}_\varphi}{\partial z'}                                    \label{eqn:cwl_norm_B_rho} \\
  \tilde{B}_z    =&\, \frac{\tilde{A}_\varphi}{\rho'} + \frac{\partial \tilde{A}_\varphi}{\partial \rho'} \label{eqn:cwl_norm_B_z}   \, .
\end{align}
Five derivatives are required in order to formulate the expressions for~$B_\rho$ and~$B_z$.
They originate from the chain rule and the product rule applied in~\eqn{cwl_norm_B_rho} and~\eqn{cwl_norm_B_z}
to the formulation of $\tilde{A}_\varphi$ in \eqn{cwl_A_phi_using_cel}.
First, consider the partial derivatives of the factor in front of cel:
\begin{align}
      \frac{\partial}{\partial z'} \left( \frac{1}{\sqrt{z'^2 + (1 + \rho')^2}} \right)
 =&\, \frac{\partial}{\partial z'} \left[ z'^2 + (1 + \rho')^2 \right]^{-1/2} \nonumber \\
 =&\, - \bcancel{\frac{1}{2}} \left[ z'^2 + (1 + \rho')^2 \right]^{-3/2} \bcancel{2} z' \nonumber \\
 =&\, \frac{- z'}{\left[ z'^2 + (1 + \rho')^2 \right]^{3/2} }
\end{align}
and
\begin{align}
      \frac{\partial}{\partial \rho'} \left( \frac{1}{\sqrt{z'^2 + (1 + \rho')^2}} \right)
 =&\, \frac{\partial}{\partial \rho'} \left[ z'^2 + (1 + \rho')^2 \right]^{-1/2} \nonumber \\
 =&\, - \bcancel{\frac{1}{2}} \left[ z'^2 + (1 + \rho')^2 \right]^{-3/2} \bcancel{2} (1 + \rho') \nonumber \\
 =&\, \frac{- (1 + \rho')}{\left[ z'^2 + (1 + \rho')^2 \right]^{3/2} } \, .
\end{align}
The denominator of the integrand in~$\textrm{cel}\,(k_c, 1, -1, 1)$ is reformulated:
\begin{align}
  \textrm{cel}\,(k_c, 1, -1, 1)
 =&\, \int\limits_0^{\pi/2} \frac{\sin^2{\varphi} - \cos^2(\varphi)}{\sqrt{\cos^2(\varphi) + k_c^2 \sin^2(\varphi)}} \,\mathrm{d}\varphi \nonumber \\
 =&\, \int\limits_0^{\pi/2} \frac{\sin^2{\varphi} - \cos^2(\varphi)}{\sqrt{1 - k^2 \sin^2(\varphi)}} \,\mathrm{d}\varphi
\end{align}
by using
\begin{align}
      \cos^2(\varphi) + k_c^2 \sin^2(\varphi)
 =&\, \cos^2(\varphi) + (1 - k^2) \sin^2(\varphi) \nonumber \\
 =&\, \underbrace{\cos^2(\varphi) + \sin^2(\varphi)}_{=1} - k^2 \sin^2(\varphi) \nonumber \\
 =&\, 1 - k^2 \sin^2(\varphi) \, .
\end{align}
The parameter of~$\textrm{cel}\,(k_c, 1, -1, 1)$ only appears in the denominator of the integrand.
This implies that it suffices to compute the derivative of the denominator
in order to compute the derivative of~$\textrm{cel}\,(k_c, 1, -1, 1)$:
\begin{align}
      \frac{\partial}{\partial(k^2)} \left( \frac{1}{\sqrt{1 - k^2 \sin^2(\varphi)}} \right)
 =&\, \frac{\partial}{\partial(k^2)} \left[1 - k^2 \sin^2(\varphi)\right]^{-1/2} \nonumber \\
 =&\, \bcancel{-} \frac{1}{2} \left[1 - k^2 \sin^2(\varphi)\right]^{-3/2} \left[ \bcancel{-} \sin^2(\varphi) \right] \nonumber \\
 =&\, \frac{1}{2} \frac{\sin^2(\varphi)}{\left[1 - k^2 \sin^2(\varphi)\right]^{3/2}} \, .
\end{align}
It follows:
\begin{equation}
  \frac{\partial}{\partial(k^2)} \textrm{cel}\,(k_c, 1, -1, 1)
 = \frac{1}{2} \int\limits_0^{\pi/2} \frac{\left[\sin^2{\varphi} - \cos^2(\varphi)\right]\sin^2(\varphi)}{\left[1 - k^2 \sin^2(\varphi)\right]^{3/2}} \,\mathrm{d}\varphi \, .
\end{equation}
The derivatives of~$k^2$ (see~\eqn{kSq}) are as follows:
\begin{align}
      \frac{\partial (k^2)}{\partial z'}
 =&\, \frac{2 z' k^2}{z'^2 + (1 + \rho')^2} \\
      \frac{\partial (k^2)}{\partial \rho'}
 =&\, \frac{1}{z'^2 + (1 + \rho')^2} \left[ 4 - k^2 2 (1 + \rho') \right] \\
 =&\, \frac{2 \left[ 2 - k^2 (1 + \rho') \right]}{z'^2 + (1 + \rho')^2} \, .
\end{align}
The next step is to use above five derivatives in deriving the expressions
for the normalized cylindrical magnetic field components.
First, $\tilde{B}_\rho$~is handled:
\begin{align}
      \tilde{B}_\rho
 =&\, - \frac{\partial \tilde{A}_\varphi}{\partial z'}
 =    - \frac{\partial}{\partial z'} \left( \frac{1}{\sqrt{z'^2 + (1 + \rho')^2}} \,\textrm{cel}\,(k_c, 1, -1, 1) \right) \nonumber \\
 =&\,          -\Biggl\{    \frac{\partial}{\partial z'} \left( \frac{1}{\sqrt{z'^2 + (1 + \rho')^2}} \right) \textrm{cel}\,(k_c, 1, -1, 1) \nonumber \\
 ~&\, \phantom{-\Biggl\{} + \frac{1}{\sqrt{z'^2 + (1 + \rho')^2}} \frac{\partial \left[\textrm{cel}\,(k_c, 1, -1, 1)\right]}{\partial(k^2)} \frac{\partial (k^2)}{\partial z'} \Biggr\} \nonumber \\
 =&\,   \frac{z'}{\left[ z'^2 + (1 + \rho')^2 \right]^{3/2}} \,\textrm{cel}\,(k_c, 1, -1, 1) \nonumber \\
 ~&\, + \frac{1}{\sqrt{z'^2 + (1 + \rho')^2}} \frac{\bcancel{2} z' k^2}{z'^2 + (1 + \rho')^2}
        \bcancel{\frac{1}{2}} \int\limits_0^{\pi/2} \frac{\left[\sin^2{\varphi} - \cos^2(\varphi)\right]\sin^2(\varphi)}{\left[1 - k^2 \sin^2(\varphi)\right]^{3/2}} \,\mathrm{d}\varphi \nonumber \\
 =&\, \frac{z'}{\left[ z'^2 + (1 + \rho')^2 \right]^{3/2}}
      \int\limits_0^{\pi/2}
        \frac{\sin^2{\varphi} - \cos^2(\varphi)}{\left[1 - k^2 \sin^2(\varphi)\right]^{3/2}}
        \left[ 1 \bcancel{-k^2\sin^2(\varphi)} \bcancel{+k^2\sin^2(\varphi)} \right] \,\mathrm{d}\varphi \nonumber \\
 =&\, \frac{z'}{\left[ z'^2 + (1 + \rho')^2 \right]^{3/2}}
      \int\limits_0^{\pi/2} \frac{\sin^2{\varphi} - \cos^2(\varphi)}{\left[1 - k^2 \sin^2(\varphi)\right]^{3/2}} \,\mathrm{d}\varphi \nonumber \\
 =&\, \frac{z'}{\left[ z'^2 + (1 + \rho')^2 \right]^{3/2}} \,\textrm{cel}\,(k_c, k_c^2, -1, 1) \, .
\end{align}
This is the normalized form of the expression for~$B_\rho$ given in Eqn.~(3.2.2.4) in Ref.~\cite{teal}.
It is now transformed into a different formulation, which forms the basis for the formulas for~$B_\rho$ presented in this work.
It holds:
\begin{equation}
   \textrm{cel}\,(k_c, k_c^2, -1, 1)
 =   \int\limits_0^{\pi/2} \frac{\sin^2{\varphi}}{\left[1 - k^2 \sin^2(\varphi)\right]^{3/2}} \,\mathrm{d}\varphi
   - \int\limits_0^{\pi/2} \frac{\cos^2{\varphi}}{\left[1 - k^2 \sin^2(\varphi)\right]^{3/2}} \,\mathrm{d}\varphi \, .
\end{equation}
The summands in this equation are reformulated separately.
The first term is transformed using the integral~(2.584.40) from Ref.~\cite{gradshteyn_ryzhik}:
\begin{equation}
   \int\limits_0^{\pi/2} \frac{\sin^2{\varphi}}{\left[1 - k^2 \sin^2(\varphi)\right]^{3/2}} \,\mathrm{d}\varphi
 = \frac{1}{k_c^2 k^2} \mathcal{E} - \frac{1}{k^2} \mathcal{K}
\end{equation}
with shorthand notations~$\mathcal{E} = \mathcal{E}(k)$ and~$\mathcal{K} = \mathcal{K}(k)$.
The second term is transformed using the integral~(2.584.42) from Ref.~\cite{gradshteyn_ryzhik}:
\begin{equation}
   \int\limits_0^{\pi/2} \frac{\cos^2{\varphi}}{\left[1 - k^2 \sin^2(\varphi)\right]^{3/2}} \,\mathrm{d}\varphi
 = \frac{1}{k^2} \mathcal{K} - \frac{1}{k^2} \mathcal{E} \, .
\end{equation}
It follows:
\begin{align}
   \textrm{cel}\,(k_c, k_c^2, -1, 1)
 =&\,   \frac{1}{k_c^2 k^2} \mathcal{E} - \frac{1}{k^2} \mathcal{K}
      - \frac{1}{k^2}       \mathcal{K} + \frac{1}{k^2} \mathcal{E} \nonumber \\
 =&\, \frac{1}{k_c^2} \left[ \frac{1 + k_c^2}{k^2} \mathcal{E} - \frac{2 k_c^2}{k^2} \mathcal{K} \right] \nonumber \\
 =&\, \frac{1}{k_c^2} \left[ \frac{2 - k^2}{k^2} \mathcal{E} - \frac{2 - 2 k^2}{k^2} \mathcal{K} \right] \nonumber \\
 =&\, \frac{1}{k_c^2} \left[ \left(\frac{2}{k^2} - 1 \right) \mathcal{E} + \left(2 - \frac{2}{k^2} \right) \mathcal{K} \right] \nonumber \\
 =&\, \frac{1}{k_c^2} \left[ 2 \mathcal{K} - \mathcal{E} - 2 \frac{\mathcal{K} - \mathcal{E}}{k^2} \right] \nonumber \\
 =&\, \frac{1}{k_c^2} \left[ 2 \mathcal{K} - \mathcal{E} - 2 \mathcal{D} \right] \label{eqn:cel_kc_kcSq}
\end{align}
with~$\mathcal{D} = \mathcal{D}(k)$.
This allows to write~$\tilde{B}_\rho$ as follows:
\begin{equation}
  \tilde{B}_\rho = \frac{z'}{\left[ z'^2 + (1 + \rho')^2 \right]^{3/2}} \frac{1}{k_c^2} \left[ 2 \mathcal{K} - \mathcal{E} - 2 \mathcal{D} \right] \, . \label{eqn:cwl_B_rho_ked}
\end{equation}
Furthermore, it is noted that:
\begin{align}
      2 \mathcal{K} - \mathcal{E} - 2 \mathcal{D}
 =&\, k^2 \left[ \frac{\mathcal{K} - \mathcal{E}}{k^2} - \frac{2 \mathcal{D} - \mathcal{K}}{k^2} \right] \nonumber \\
 =&\, k^2 \left(  \mathcal{D} - \mathcal{C} \right) \, . \label{eqn:kSq_D_C}
\end{align}
This is used to write~$\tilde{B}_\rho$ as follows:
\begin{align}
  \tilde{B}_\rho
 =&\, \frac{z'}{\left[ z'^2 + (1 + \rho')^2 \right]^{3/2}} \frac{k^2}{k_c^2} \left(  \mathcal{D} - \mathcal{C} \right) \nonumber \\
 =&\, \frac{4 \rho' z' \left(  \mathcal{D} - \mathcal{C} \right) }{\left[ z'^2 + (1 + \rho')^2 \right]^{3/2} \left[ z'^2 + (1 - \rho')^2 \right]} \, .
\end{align}
This is the form of~$\tilde{B}_\rho$ used in \eqn{cwl_B_rho_f}.
The near-field formulation is obtained from this by normalizing to~$\rho'-1$:
\begin{equation}
  \tilde{B}_\rho
 = \frac{4 \rho' \frac{z'}{|\rho'-1|} \left( \mathcal{D} - \mathcal{C} \right) }
        {(\rho'-1)^4 \left[ \left(\frac{z'}{\rho'-1}\right)^2 + \left(1 + \frac{2}{\rho'-1}\right)^2 \right]^{3/2}
                     \left[ \left(\frac{z'}{\rho'-1}\right)^2 + 1 \right]} \, .
\end{equation}
This formulation cannot be used at~$\rho'=1$ close to the wire loop
due to the vanishing denominator in that case.
Thus, one more formulation is required for~$\tilde{B}_\rho$.
The derivation starts from~\eqn{cwl_B_rho_ked} and $\rho'=1$~is inserted:
\begin{align}
  \tilde{B}_\rho
 =&\, \frac{z'}{\left[ z'^2 + 4 \right]^{3/2}} \frac{z'^2 + 4}{z'^2} \left[ 2 \mathcal{K} - \mathcal{E} - 2 \mathcal{D} \right] \nonumber \\
 =&\, \frac{1}{z'^2 \sqrt{1 + 4/z'^2}} \left[ 2 \mathcal{K} - \mathcal{E} - 2 \mathcal{D} \right] \nonumber \\
\end{align}
Furthermore:
\begin{align}
      2 \mathcal{K} - \mathcal{E} - 2 \mathcal{D}
 =&\, 2 \mathcal{K} - \mathcal{E} - 2 \frac{\mathcal{K} - \mathcal{E}}{k^2} \nonumber \\
 =&\, \left( 2 - \frac{2}{k^2} \right) \mathcal{K} + \left( \frac{2}{k^2} - 1 \right) \mathcal{E} \nonumber \\
 =&\, \left( 2 - \frac{2(z'^2+4)}{4} \right) \mathcal{K} + \frac{2(z'^2+4) - 4}{4} \mathcal{E} \nonumber \\
 =&\, \frac{4 - z'^2 -4}{2} \mathcal{K} + \frac{2 z'^2 + 8 - 4}{4} \mathcal{E} \nonumber \\
 =&\, -\frac{1}{2} z'^2 \mathcal{K} + \frac{1}{2}\left(z'^2 +2\right) \mathcal{E} \, .
\end{align}
This allows to write:
\begin{equation}
 \tilde{B}_\rho = \frac{1}{2} k_c \left[ \left( \frac{2}{z'^2} + 1 \right) \mathcal{E} - \mathcal{K} \right] \, .
\end{equation}
This is the formulation used in~\eqn{cwl_B_rho_v}.
In order to derive the vertical component of the magnetic field,~$\tilde{B}_z$,
we start again from~\eqn{cwl_A_phi_using_cel} for the magnetic vector potential
and insert it into~\eqn{cwl_norm_B_z}:
\begin{align}
 \tilde{B}_z
 =&\,   \frac{1}{\rho' \sqrt{z'^2 + (1 + \rho')^2}} \,\textrm{cel}\,(k_c, 1, -1, 1) \nonumber \\
 ~&\, + \frac{\partial}{\partial \rho'} \left[ \frac{1}{\sqrt{z'^2 + (1 + \rho')^2}} \,\textrm{cel}\,(k_c, 1, -1, 1) \right] \nonumber \\
 =&\,   \frac{1}{\rho' \sqrt{z'^2 + (1 + \rho')^2}} \,\textrm{cel}\,(k_c, 1, -1, 1) \nonumber \\
 ~&\, + \frac{\partial}{\partial \rho'} \left[ \frac{1}{\sqrt{z'^2 + (1 + \rho')^2}} \right] \textrm{cel}\,(k_c, 1, -1, 1) \nonumber \\
 ~&\, + \frac{1}{\sqrt{z'^2 + (1 + \rho')^2}} \frac{\partial}{\partial (k^2)} \,\textrm{cel}\,(k_c, 1, -1, 1) \frac{\partial (k^2)}{\partial \rho'} \, .
\end{align}
Continuing:
\begin{align}
 \tilde{B}_z
 =&\,   \frac{1}{\rho' \sqrt{z'^2 + (1 + \rho')^2}} \,\textrm{cel}\,(k_c, 1, -1, 1) \nonumber \\
 ~&\, + \frac{-(1 + \rho')}{\left[z'^2 + (1 + \rho')^2\right]^{3/2}} \textrm{cel}\,(k_c, 1, -1, 1) \nonumber \\
 ~&\, + \frac{1}{\sqrt{z'^2 + (1 + \rho')^2}}
          \frac{\bcancel{2} \left[2 - k^2(1+\rho')\right]}{z'^2 + (1 + \rho')^2}
          \bcancel{\frac{1}{2}} \int\limits_0^{\pi/2} \frac{\left[\sin^2{\varphi} - \cos^2(\varphi)\right]\sin^2(\varphi)}{\left[1 - k^2 \sin^2(\varphi)\right]^{3/2}} \,\mathrm{d}\varphi \nonumber \\
 =&\, \frac{1}{\rho' \sqrt{z'^2 + (1 + \rho')^2}} \Biggl\{
        \int\limits_0^{\pi/2}
          \frac{\sin^2{\varphi} - \cos^2(\varphi)}{\sqrt{1 - k^2 \sin^2(\varphi)}}
          \left[1 - \frac{\rho'(1 + \rho')}{z'^2 + (1 + \rho')^2} \right] \,\mathrm{d}\varphi \nonumber \\
 ~&\, + \frac{\rho'\left[2 - k^2(1+\rho')\right]}{z'^2 + (1 + \rho')^2}
        \int\limits_0^{\pi/2}
          \frac{\left[\sin^2{\varphi} - \cos^2(\varphi)\right]\sin^2{\varphi}}{\left[1 - k^2 \sin^2(\varphi)\right]^{3/2}} \,\mathrm{d}\varphi \Biggr\}
\end{align}
The integrals can be combined to arrive at:
\begin{align}
 \tilde{B}_z
 =&\, \frac{1}{\rho' \sqrt{z'^2 + (1 + \rho')^2}}
      \int\limits_0^{\pi/2}
        \frac{\sin^2{\varphi} - \cos^2(\varphi)}{\left[1 - k^2 \sin^2(\varphi)\right]^{3/2}} \Biggl\{ \left[1 - k^2 \sin^2(\varphi)\right] \nonumber \\
 ~&\,        \left[1 - \frac{\rho'(1 + \rho')}{z'^2 + (1 + \rho')^2} \right]
          + \frac{\rho'\left[2 - k^2(1+\rho')\right]}{z'^2 + (1 + \rho')^2} \sin^2{\varphi} \Biggr\} \,\mathrm{d}\varphi \, . \label{eqn:cwl_B_z_halfway}
\end{align}
Consider the part inside~$\{\}$ in the integrand in more detail:
\begin{align}
 ~&\,   \left[1 - k^2 \sin^2(\varphi)\right] \left[1 - \frac{\rho'(1 + \rho')}{z'^2 + (1 + \rho')^2} \right]
      + \frac{\rho'\left[2 - k^2(1+\rho')\right]}{z'^2 + (1 + \rho')^2} \sin^2{\varphi} \nonumber \\
 =&\, 1 - k^2 \sin^2(\varphi) - \frac{\rho'(1 + \rho')}{z'^2 + (1 + \rho')^2}
        \bcancel{+\frac{\rho' k^2 (1 + \rho')}{z'^2 + (1 + \rho')^2} \sin^2{\varphi}} \nonumber \\
 ~&\,   + \underbrace{\frac{2 \rho'}{z'^2 + (1 + \rho')^2}}_{=k^2/2} \sin^2{\varphi}
        \bcancel{-\frac{\rho' k^2 (1+\rho')}{z'^2 + (1 + \rho')^2} \sin^2{\varphi}} \nonumber \\
 =&\, \frac{1}{2} \left[1 - k^2 \sin^2{\varphi} \right] + \frac{1}{2} - (1+\rho') \frac{\rho'}{z'^2 + (1 + \rho')^2} \nonumber \\
 =&\, \frac{1}{2} \left[1 - k^2 \sin^2{\varphi} \right] + \frac{1}{2} - (1+\rho') \frac{1}{4} k^2 \nonumber \\
 =&\, \frac{1}{2} \left[1 - k^2 \sin^2{\varphi} \right] + \frac{1}{4} \left[2 - k^2 (1+\rho') \right] \, .
\end{align}
Inserting this back into~\eqn{cwl_B_z_halfway} leads to:
\begin{align}
 \tilde{B}_z
 =&\, \frac{1}{\rho' \sqrt{z'^2 + (1 + \rho')^2}}
      \int\limits_0^{\pi/2}
        \frac{\sin^2{\varphi} - \cos^2(\varphi)}{\left[1 - k^2 \sin^2(\varphi)\right]^{3/2}} \nonumber \\
 ~&\, \left\{ \frac{1}{2} \left[1 - k^2 \sin^2{\varphi} \right] + \frac{1}{4} \left[2 - k^2 (1+\rho') \right] \right\} \,\mathrm{d}\varphi \nonumber \\
 =&\, \frac{1}{\rho' \sqrt{z'^2 + (1 + \rho')^2}} \Biggl\{
          \frac{1}{2} \int\limits_0^{\pi/2} \frac{\sin^2{\varphi} - \cos^2(\varphi)}{\sqrt{1 - k^2 \sin^2(\varphi)}} \,\mathrm{d}\varphi \nonumber \\
 ~&\, + \frac{1}{4} \left[2 - k^2 (1+\rho') \right] \int\limits_0^{\pi/2}
        \frac{\sin^2{\varphi} - \cos^2(\varphi)}{\left[1 - k^2 \sin^2(\varphi)\right]^{3/2}} \,\mathrm{d}\varphi \Biggr\}
\end{align}
Here, the two integrals can be re-expressed using cel:
\begin{align}
 \tilde{B}_z
 =&\, \frac{1}{2 \rho' \sqrt{z'^2 + (1 + \rho')^2}} \Bigl[ \,\textrm{cel}\,(k_c, 1, -1, 1) \nonumber \\
 ~&\, + \frac{1}{2} \left[2 - k^2 (1+\rho') \right] \,\textrm{cel}\,(k_c, k_c^2, -1, 1) \Bigr] \, . \label{eqn:cwl_B_z_teal}
\end{align}
This is the formulation of~$\tilde{B_z}$ given as~(3.2.2.6) in Ref.~\cite{teal} with
\begin{equation}
   2 - k^2(1 + \rho')
 = 2 - k^2 - k^2 \rho'
 = 1 + k_c^2 - (1 - k_c^2) \rho' \, .
\end{equation}
It is now shown how this formulation can be transformed into
the formulation povided by Walstrom in Eqn.~(17) of Ref.~\cite{walstrom_2017}.
First, consider:
\begin{align}
  k^2 =&\, \frac{4 \rho'}{z'^2 + (1+\rho')^2} \nonumber \\
  \Leftrightarrow
  \frac{1}{\rho'} =&\, \frac{4}{k^2} \frac{1}{z'^2 + (1+\rho')^2} \, .
\end{align}
Inserting this into~\eqn{cwl_B_z_teal} leads to:
\begin{align}
 \tilde{B}_z
 =&\, \frac{1}{\left[z'^2 + (1 + \rho')^2\right]^{3/2}} \frac{2}{k^2} \Biggl\{
      -\rho' \frac{k^2}{2} \,\textrm{cel}\,(k_c, k_c^2, -1, 1) \nonumber \\
 ~&\, + \,\textrm{cel}\,(k_c, 1, -1, 1) + \frac{1 + k_c^2}{2} \,\textrm{cel}\,(k_c, k_c^2, -1, 1) \Biggr\} \nonumber \\
 =&\, \frac{1}{\left[z'^2 + (1 + \rho')^2\right]^{3/2}}  \Biggl\{
      -\rho' \,\textrm{cel}\,(k_c, k_c^2, -1, 1) \nonumber \\
 ~&\, + \frac{2}{k^2} \left[ \,\textrm{cel}\,(k_c, 1, -1, 1) + \frac{1 + k_c^2}{2} \,\textrm{cel}\,(k_c, k_c^2, -1, 1) \right] \Biggr\} \nonumber \\
\end{align}
Using~\eqn{cel_kc_kcSq}, this is rewritten has:
\begin{align}
 \tilde{B}_z
 =&\, \frac{1}{\left[z'^2 + (1 + \rho')^2\right]^{3/2}}  \Biggl\{
      -\rho' \frac{1}{k_c^2} \left[ 2 \mathcal{K} - \mathcal{E} - 2 \mathcal{D} \right] \nonumber \\
 ~&\, + \frac{2}{k^2} \left[ \,\textrm{cel}\,(k_c, 1, -1, 1) + \frac{1 + k_c^2}{2} \,\textrm{cel}\,(k_c, k_c^2, -1, 1) \right] \Biggr\} \label{eqn:cwl_B_z_intermediate} \\
 =&\, \frac{1}{\left[z'^2 + (1 + \rho')^2\right]^{3/2}} \frac{1}{k_c^2} \Biggl\{
      -\rho' \left[ 2 \mathcal{K} - \mathcal{E} - 2 \mathcal{D} \right] \nonumber \\
 ~&\, + \frac{2 k_c^2}{k^2} \left[ \,\textrm{cel}\,(k_c, 1, -1, 1) + \frac{1 + k_c^2}{2} \,\textrm{cel}\,(k_c, k_c^2, -1, 1) \right] \Biggr\} \, .
\end{align}
Consider the following:
\begin{align}
      \frac{1}{\left[z'^2 + (1 + \rho')^2\right]^{3/2}} \frac{1}{k_c^2}
 =&\, \frac{1}{\left[z'^2 + (1 + \rho')^2\right]^{3/2}} \frac{z'^2 + (1 + \rho')^2}{z'^2 + (1 - \rho')^2} \nonumber \\
 =&\, \frac{1}{\sqrt{z'^2 + (1 + \rho')^2} \left[z'^2 + (1 - \rho')^2\right]} \, .
\end{align}
This leads to:
\begin{align}
 \tilde{B}_z
 =&\, \frac{1}{\sqrt{z'^2 + (1 + \rho')^2} \left[z'^2 + (1 - \rho')^2\right]} \Biggl\{
      -\rho' \left[ 2 \mathcal{K} - \mathcal{E} - 2 \mathcal{D} \right] \nonumber \\
 ~&\, + \underbrace{\frac{2 k_c^2}{k^2} \left[ \,\textrm{cel}\,(k_c, 1, -1, 1) + \frac{1 + k_c^2}{2} \,\textrm{cel}\,(k_c, k_c^2, -1, 1) \right]}_{\equiv(*)} \Biggr\} \, .
\end{align}
Consider~$(*)$ alone for now and use~\eqn{cel_kc_1} and~\eqn{cel_kc_kcSq}:
\begin{align}
  (*)
 =&\, \frac{k_c^2}{k^2} \left[ 2 \,\textrm{cel}\,(k_c, 1, -1, 1) + (1 + k_c^2) \,\textrm{cel}\,(k_c, k_c^2, -1, 1) \right] \nonumber \\
 =&\, \frac{1}{k^4} \left\{ 2(1 - k^2) \left[(2-k^2)\mathcal{K} - 2 \mathcal{E} \right] + k^2 (2 - k^2) \left[2\mathcal{K} - \mathcal{E} - 2 \mathcal{D} \right] \right\} \nonumber \\
 =&\, \frac{1}{k^4} \left\{ k^4 \mathcal{E} \right\} = \mathcal{E} \, . \label{eqn:cwl_B_z_star}
\end{align}
It follows:
\begin{equation}
 \tilde{B}_z
 = \frac{\mathcal{E} + \rho' \left[\mathcal{E} - 2 \mathcal{K} + 2 \mathcal{D} \right]}
        {\sqrt{z'^2 + (1 + \rho')^2} \left[z'^2 + (1 - \rho')^2\right]} \, . \label{eqn:cwl_B_z_f1_appendix}
\end{equation}
This is equivalent to the formulation presented in Eqn.~(17) of Ref.~\cite{walstrom_2017},
which also is the formulation used to compute $\tilde{B}_z$ in~\eqn{cwl_B_z_f1} of this work.
This is normalized to~$\rho'^2$ in the following for evaluation at large values of~$\rho'$.
First consider the terms in the denominator of~\eqn{cwl_B_z_f1_appendix}:
\begin{align}
  \frac{1}{\rho'^2} \left[ z'^2 + (1 + \rho')^2 \right]
 =&\, \frac{1}{\rho'^2} \left( z'^2 + 1 + 2 \rho' + \rho'^2 \right) \nonumber \\
 =&\, \frac{z'^2 + 1}{\rho'^2} + 1 + \frac{2}{\rho'} = t_1 + t_2 \nonumber \\
 \frac{1}{\rho'^2} \left[ z'^2 + (1 - \rho')^2 \right]
 =&\, \frac{1}{\rho'^2} \left( z'^2 + 1 - 2 \rho' + \rho'^2 \right) \nonumber \\
 =&\, \frac{z'^2 + 1}{\rho'^2} + 1 - \frac{2}{\rho'} = t_1 - t_2
\end{align}
with
\begin{align}
  t_1 \equiv&\, \frac{z'^2 + 1}{\rho'^2} + 1 \\
  t_2 \equiv&\, \frac{2}{\rho'} \, .
\end{align}
It follows:
\begin{equation}
  \tilde{B}_z
 = \frac{\mathcal{E} + \rho' \left[\mathcal{E} - 2 \mathcal{K} + 2 \mathcal{D} \right]}
        {\sqrt{t_1 + t_2} (t_1 - t_2) \rho'^3}
\end{equation}
and with~\eqn{kSq_D_C} we arrive at:
\begin{equation}
  \tilde{B}_z
 = \frac{\mathcal{E} + \rho' k^2 \left[\mathcal{C} - \mathcal{D} \right]}
        {\sqrt{t_1 + t_2} (t_1 - t_2) \rho'^3} \, .
\end{equation}
Furthermore, it holds:
\begin{align}
  \rho' k^2
 =&\, \rho' \frac{4 \rho'}{z'^2 + (1 + \rho')^2} \nonumber \\
 =&\, 4 / \left\{ \frac{1}{\rho'^2} \left[ z'^2 + (1 + \rho')^2 \right] \right\} \nonumber \\
 =&\, 4 / \left[ \left( \frac{z'}{\rho'} \right)^2 + \left( \frac{1 + \rho'}{\rho'} \right)^2 \right]
 = 4 / \alpha_\textrm{cd}
\end{align}
with
\begin{align}
  \alpha_\textrm{cd}
 =&\, \frac{z'^2}{\rho'^2} + \frac{1 + 2 \rho' + \rho'^2}{\rho'^2} \nonumber \\
 =&\, \frac{1}{\rho'^2} \left[ \rho'^2 + 2 \rho' + 1 + z'^2 \right] \nonumber \\
 =&\, 1 + \frac{1}{\rho'} \left[ 2 + \frac{1}{\rho'} \left( 1 + z'^2 \right) \right] \, .
\end{align}
Putting things back together, we arrive at:
\begin{equation}
  \tilde{B}_z
 = \frac{1}{\sqrt{t_1 + t_2} (t_1 - t_2) \rho'^3}
   \left[
     \mathcal{E} + \frac{4 \left(\mathcal{C} - \mathcal{D} \right)}{1 + \frac{1}{\rho'} \left[ 2 + \frac{1}{\rho'} \left( 1 + z'^2 \right) \right]}
   \right] \, .
\end{equation}
This is the formulation used in~\eqn{cwl_B_z_f2} of this work.
One more formulation of~$\tilde{B}_z$ is required for this work.
The derivation starts at~\eqn{cwl_B_z_intermediate}, which is reformulated
using~\eqn{cwl_B_z_star} and~\eqn{cel_kc_kcSq} as follows:
\begin{align}
 \tilde{B}_z
 =&\, \frac{1}{\left[z'^2 + (1 + \rho')^2\right]^{3/2}} \frac{1}{k_c^2}
      \left[ \mathcal{E} -\rho' \left( 2 \mathcal{K} - \mathcal{E} - 2 \mathcal{D} \right) \right] \nonumber \\
 =&\, \frac{1}{\left[z'^2 + (1 + \rho')^2\right]^{3/2}}
      \left[ \frac{1}{k_c^2} \mathcal{E} - \rho' \frac{1}{k_c^2} \left( 2 \mathcal{K} - \mathcal{E} - 2 \mathcal{D} \right) \right] \nonumber \\
 =&\, \frac{1}{\left[z'^2 + (1 + \rho')^2\right]^{3/2}}
      \left[ \frac{1}{k_c^2} \mathcal{E} - \rho' \,\textrm{cel}\,(k_c, k_c^2, -1, 1) \right] \, .
\end{align}
Integral~(2.584.37) from Ref.~\cite{gradshteyn_ryzhik} is used as follows:
\begin{align}
  \frac{1}{k_c^2} \mathcal{E}
 =&\, \int\limits_0^{\pi/2}
        \frac{1}{\left[ 1 - k^2 \sin^2(\varphi) \right]^{3/2}}
        \,\mathrm{d}\varphi \nonumber \\
 =&\, \,\textrm{cel}\,(k_c, k_c^2, 1, 1) \, .
\end{align}
It follows:
\begin{equation}
  \tilde{B}_z
 = \frac{1}{\left[z'^2 + (1 + \rho')^2\right]^{3/2}} \,\textrm{cel}\,(k_c, k_c^2, 1 + \rho', 1 - \rho') \, . \label{eqn:cwl_B_z_14}
\end{equation}
This is the formulation of~$\tilde{B}_z$ consistent with Eqn.~(14) of Ref.~\cite{walstrom_2017}.
The terms in~\eqn{cwl_B_z_14} are now normalized to $\rho'-1$ for use close to the wire loop.
Then:
\begin{align}
  \frac{1}{\left[z'^2 + (1 + \rho')^2\right]^{3/2}}
 =&\, \left| \rho' - 1 \right|^{-3} \left[ \left(\frac{z'}{\rho'-1}\right)^2 + \left( \frac{\rho' + 1}{\rho'-1} \right)^2 \right]^{-3/2} \nonumber \\
 =&\, \left| \rho' - 1 \right|^{-3} \left[ n^2 + m^2 \right]^{-3/2}
\end{align}
Putting things back together, we arrive at:
\begin{equation}
  \tilde{B}_z
 = \frac{1}{\left| \rho' - 1 \right|^3 \left[ n^2 + m^2 \right]^{3/2} } \,\textrm{cel}\,(k_c, k_c^2, 1 + \rho', 1 - \rho')
\end{equation}
with~$k_c = \sqrt{k_c^2}$ and $k_c^2$ from \eqn{cwl_kCSq_mn}.
This is the formulation used in \eqn{cwl_B_z_n} of this work.
Above expression cannot be used to compute~$\tilde{B}_z$ close to the wire loop at $\rho'=1$.
Therefore, one final special-case formulation is required.
The derivation starts again with \eqn{cwl_B_z_14} and $\rho'=1$~is inserted.
This leads to:
\begin{equation}
  \tilde{B}_z = \frac{1}{\left[ z'^2 + 4 \right]^{3/2}} \,\textrm{cel}\,(k_c, k_c^2, 2, 0)
\end{equation}
with
\begin{equation}
  k_c^2 = \frac{z'^2}{z'^2 + 4} \, .
\end{equation}
This is the formulation used in \eqn{cwl_B_z_v} of this work.

